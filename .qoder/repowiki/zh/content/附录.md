# 附录

<cite>
**本文档中引用的文件**   
- [keyboard-shortcuts.md](file://docs/cli/keyboard-shortcuts.md)
- [themes.md](file://docs/cli/themes.md)
- [faq.md](file://docs/faq.md)
- [keyBindings.ts](file://packages/cli/src/config/keyBindings.ts)
- [settings.ts](file://packages/cli/src/config/settings.ts)
- [clearCommand.ts](file://packages/cli/src/ui/commands/clearCommand.ts)
</cite>

## 目录
1. [键盘快捷键](#键盘快捷键)
2. [主题](#主题)
3. [常见问题解答](#常见问题解答)

## 键盘快捷键

Gemini CLI 提供了一组默认的键盘快捷键，用于编辑输入、导航历史记录和控制用户界面。以下按功能分组列出完整的快捷键列表。

### 基本控制
| 操作 | 快捷键 |
| -------------------------------------------- | ------- |
| 确认当前选择或选项。 | `Enter` |
| 关闭对话框或取消当前焦点。 | `Esc` |

### 光标移动
| 操作 | 快捷键 |
| ----------------------------------------- | ---------------------- |
| 将光标移动到行首。 | `Ctrl + A`<br />`Home` |
| 将光标移动到行尾。 | `Ctrl + E`<br />`End` |

### 编辑
| 操作 | 快捷键 |
| ------------------------------------------------ | ----------------------------------------- |
| 删除从光标到行尾的所有内容。 | `Ctrl + K` |
| 删除从光标到行首的所有内容。 | `Ctrl + U` |
| 清除输入字段中的所有文本。 | `Ctrl + C` |
| 删除前一个单词。 | `Ctrl + Backspace`<br />`Cmd + Backspace` |

### 屏幕控制
| 操作 | 快捷键 |
| -------------------------------------------- | ---------- |
| 清除终端屏幕并重新绘制用户界面。 | `Ctrl + L` |

### 滚动
| 操作 | 快捷键 |
| ------------------------ | -------------------- |
| 向上滚动内容。 | `Shift + Up Arrow` |
| 向下滚动内容。 | `Shift + Down Arrow` |
| 滚动到顶部。 | `Home` |
| 滚动到底部。 | `End` |
| 向上滚动一页。 | `Page Up` |
| 向下滚动一页。 | `Page Down` |

### 历史记录与搜索
| 操作 | 快捷键 |
| -------------------------------------------- | --------------------- |
| 显示历史记录中的上一个条目。 | `Ctrl + P (无 Shift)` |
| 显示历史记录中的下一个条目。 | `Ctrl + N (无 Shift)` |
| 开始反向搜索历史记录。 | `Ctrl + R` |
| 插入选定的反向搜索匹配项。 | `Enter (无 Ctrl)` |
| 在反向搜索时接受建议。 | `Tab` |

### 导航
| 操作 | 快捷键 |
| -------------------------------- | ------------------------------------------- |
| 在列表中向上移动选择。 | `Up Arrow (无 Shift)` |
| 在列表中向下移动选择。 | `Down Arrow (无 Shift)` |
| 在对话框选项中向上移动。 | `Up Arrow (无 Shift)`<br />`K (无 Shift)` |
| 在对话框选项中向下移动。 | `Down Arrow (无 Shift)`<br />`J (无 Shift)` |

### 建议与补全
| 操作 | 快捷键 |
| --------------------------------------- | -------------------------------------------------- |
| 接受内联建议。 | `Tab`<br />`Enter (无 Ctrl)` |
| 移动到上一个补全选项。 | `Up Arrow (无 Shift)`<br />`Ctrl + P (无 Shift)` |
| 移动到下一个补全选项。 | `Down Arrow (无 Shift)`<br />`Ctrl + N (无 Shift)` |
| 展开内联建议。 | `Right Arrow` |
| 折叠内联建议。 | `Left Arrow` |

### 文本输入
| 操作 | 快捷键 |
| ------------------------------------ | ------------------------------------------------------------------------------------------- |
| 提交当前提示。 | `Enter (无 Ctrl, 无 Shift, 无 Cmd, 非粘贴)` |
| 插入换行符而不提交。 | `Ctrl + Enter`<br />`Cmd + Enter`<br />`粘贴 + Enter`<br />`Shift + Enter`<br />`Ctrl + J` |

### 外部工具
| 操作 | 快捷键 |
| ---------------------------------------------- | ---------- |
| 在外部编辑器中打开当前提示。 | `Ctrl + X` |
| 从剪贴板粘贴。 | `Ctrl + V` |

### 应用程序控制
| 操作 | 快捷键 |
| ----------------------------------------------------------------- | ---------- |
| 切换详细错误信息。 | `F12` |
| 切换完整 TODO 列表。 | `Ctrl + T` |
| 切换 IDE 上下文详细信息。 | `Ctrl + G` |
| 切换 Markdown 渲染。 | `Cmd + M` |
| 当终端使用备用缓冲区时，切换复制模式。 | `Ctrl + S` |
| 展开高度受限的响应以显示更多行。 | `Ctrl + S` |
| 在 shell 和 Gemini 输入之间切换焦点。 | `Ctrl + F` |

### 会话控制
| 操作 | 快捷键 |
| -------------------------------------------- | ---------- |
| 取消当前请求或退出 CLI。 | `Ctrl + C` |
| 当输入缓冲区为空时退出 CLI。 | `Ctrl + D` |

#### 其他上下文相关快捷键
- `Ctrl+Y`: 切换 YOLO（自动批准）模式以进行工具调用。
- `Shift+Tab`: 切换自动编辑（自动接受编辑）模式。
- `Option+M` (macOS): 使用 Option+M 输入 `µ` 也会切换 Markdown 渲染，与 `Cmd+M` 相同。
- `!` 在空提示符上：进入或退出 shell 模式。
- `\` (在行尾) + `Enter`: 插入换行符而不离开单行模式。
- `Ctrl+Delete` / `Meta+Delete`: 删除光标右侧的单词。
- `Ctrl+B` 或 `Left Arrow`: 在编辑文本时将光标向左移动一个字符。
- `Ctrl+F` 或 `Right Arrow`: 将光标向右移动一个字符；附加嵌入式 shell 时，`Ctrl+F` 仍会切换焦点。
- `Ctrl+D` 或 `Delete`: 删除光标右侧的字符。
- `Ctrl+H` 或 `Backspace`: 删除光标左侧的字符。
- `Ctrl+Left Arrow` / `Meta+Left Arrow` / `Meta+B`: 向左移动一个单词。
- `Ctrl+Right Arrow` / `Meta+Right Arrow` / `Meta+F`: 向右移动一个单词。
- `Ctrl+W`: 删除光标左侧的单词（除了 `Ctrl+Backspace` / `Cmd+Backspace`）。
- `Ctrl+Z` / `Ctrl+Shift+Z`: 撤销或重做最近的文本编辑。
- `Meta+Enter`: 在外部编辑器中打开当前输入（`Ctrl+X` 的别名）。
- 快速按两次 `Esc`: 清除当前输入缓冲区。
- `Up Arrow` / `Down Arrow`: 当光标位于单行输入的顶部或底部时，向后或向前导航提示历史记录。
- `数字键 (1-9, 多位数)` 在选择对话框内：直接跳转到编号的单选选项并在输入完整数字后确认。

**自定义快捷键说明**：
快捷键可以通过在 `settings.json` 配置文件中修改 `keyBindings` 设置来自定义。所有快捷键的定义都位于 `keyBindings.ts` 文件中，遵循数据驱动的结构，允许用户通过配置覆盖默认绑定。

**Section sources**
- [keyboard-shortcuts.md](file://docs/cli/keyboard-shortcuts.md)
- [keyBindings.ts](file://packages/cli/src/config/keyBindings.ts)

## 主题

Gemini CLI 支持多种主题来定制其颜色方案和外观。您可以使用 `/theme` 命令或 `"theme":` 配置设置来更改主题。

### 可用主题

Gemini CLI 提供了一系列预定义主题，您可以在 CLI 中使用 `/theme` 命令列出它们：

- **深色主题:**
  - `ANSI`
  - `Atom One`
  - `Ayu`
  - `Default`
  - `Dracula`
  - `GitHub`
- **浅色主题:**
  - `ANSI Light`
  - `Ayu Light`
  - `Default Light`
  - `GitHub Light`
  - `Google Code`
  - `Xcode`

### 切换主题

1.  在 Gemini CLI 中输入 `/theme`。
2.  将出现一个对话框或选择提示，列出可用的主题。
3.  使用箭头键选择一个主题。某些界面可能会提供实时预览或在选择时高亮显示。
4.  确认选择以应用主题。

**注意**：如果在 `settings.json` 文件中定义了主题（通过名称或文件路径），则必须先从文件中移除 `"theme"` 设置，才能使用 `/theme` 命令更改主题。

### 主题持久化

所选主题会保存在 Gemini CLI 的[配置](../get-started/configuration.md)中，以便您的偏好在会话之间保持不变。

### 自定义颜色主题

Gemini CLI 允许您通过在 `settings.json` 文件中指定来自定义自己的颜色主题。这使您可以完全控制 CLI 中使用的调色板。

#### 如何定义自定义主题

在用户、项目或系统 `settings.json` 文件中添加一个 `customThemes` 块。每个自定义主题都定义为一个具有唯一名称和一组颜色键的对象。例如：

```json
{
  "ui": {
    "customThemes": {
      "MyCustomTheme": {
        "name": "MyCustomTheme",
        "type": "custom",
        "Background": "#181818",
        ...
      }
    }
  }
}
```

**颜色键**:
- `Background`
- `Foreground`
- `LightBlue`
- `AccentBlue`
- `AccentPurple`
- `AccentCyan`
- `AccentGreen`
- `AccentYellow`
- `AccentRed`
- `Comment`
- `Gray`
- `DiffAdded` (可选，用于差异中的添加行)
- `DiffRemoved` (可选，用于差异中的删除行)
- `DiffModified` (可选，用于差异中的修改行)

您还可以通过添加嵌套的 `text` 对象来覆盖单个 UI 文本角色。此对象支持 `primary`、`secondary`、`link`、`accent` 和 `response` 键。当提供 `text.response` 时，它优先于 `text.primary` 用于在聊天中渲染模型响应。

**必需属性**:
- `name` (必须与 `customThemes` 对象中的键匹配且为字符串)
- `type` (必须是字符串 `"custom"`)
- `Background`
- `Foreground`
- `LightBlue`
- `AccentBlue`
- `AccentPurple`
- `AccentCyan`
- `AccentGreen`
- `AccentYellow`
- `AccentRed`
- `Comment`
- `Gray`

您可以使用十六进制代码（例如 `#FF0000`）或标准 CSS 颜色名称（例如 `coral`、`teal`、`blue`）作为任何颜色值。

#### 从文件加载主题

除了在 `settings.json` 中定义自定义主题外，您还可以通过在 `settings.json` 中指定文件路径直接从 JSON 文件加载主题。这对于共享主题或将它们与主配置分开很有用。

要从文件加载主题，请将 `settings.json` 中的 `theme` 属性设置为您的主题文件路径：

```json
{
  "ui": {
    "theme": "/path/to/your/theme.json"
  }
}
```

主题文件必须是有效的 JSON 文件，其结构与在 `settings.json` 中定义的自定义主题相同。

**安全说明**：为了您的安全，Gemini CLI 只会加载位于您的主目录内的主题文件。如果您尝试从主目录外加载主题，将显示警告并且主题不会被加载。这是为了防止从不受信任的来源加载可能恶意的主题文件。

**Section sources**
- [themes.md](file://docs/cli/themes.md)

## 常见问题解答

本部分回答用户最常遇到的问题。

### 如何清除会话历史？

您可以通过以下几种方式清除会话历史：
1.  **使用命令**：在 CLI 中输入 `/clear` 命令。这将清除屏幕和对话历史。
2.  **使用快捷键**：按下 `Ctrl + C` 可以取消当前请求并清除会话。
3.  **从命令行**：使用 `gemini --delete-session <index_or_id>` 命令删除特定会话，或使用 `gemini --list-sessions` 查看所有会话。

清除会话会触发 `SessionEnd` 钩子，然后调用 `resetChat()` 方法来重置聊天记录。

**Section sources**
- [clearCommand.ts](file://packages/cli/src/ui/commands/clearCommand.ts)
- [session-management.md](file://docs/cli/session-management.md)

### 为什么某些工具被禁用？

某些工具可能被禁用，原因如下：
1.  **配置排除**：工具可能在 `settings.json` 配置文件中被明确排除。在 `tools.exclude` 列表中指定的工具会被禁用。
2.  **MCP 服务器限制**：如果工具来自 MCP（Model Context Protocol）服务器，该服务器可能在 `mcp.excluded` 列表中被阻止。
3.  **安全策略**：系统范围的策略引擎可能会根据安全规则阻止某些工具。例如，写入文件或执行 shell 命令的工具默认需要用户确认。
4.  **权限不足**：某些工具可能需要特定的 API 密钥或权限才能运行。

工具的启用/禁用状态由策略引擎根据配置和优先级规则动态决定。

**Section sources**
- [config.ts](file://packages/core/src/policy/config.ts)
- [tool-registry.ts](file://packages/core/src/tools/tool-registry.ts)

### 如何提高响应速度？

提高响应速度的方法包括：
1.  **优化提示**：确保您的提示清晰、简洁，并提供足够的上下文。避免过于宽泛或模糊的请求。
2.  **管理上下文**：使用 `/context` 命令管理上下文大小。减少不必要的文件或信息可以加快处理速度。
3.  **检查网络**：确保您的网络连接稳定。API 请求延迟会直接影响响应时间。
4.  **升级订阅**：如果您是 Google AI Pro 或 Ultra 订阅者，您将获得更高的 API 速率限制，这可以显著提高性能。
5.  **关闭不必要的工具**：禁用不需要的工具可以减少处理开销。您可以在 `settings.json` 中配置 `tools.exclude`。
6.  **使用缓存**：确保启用了令牌缓存（对于 API 密钥用户），这可以避免重复计算。

**Section sources**
- [faq.md](file://docs/faq.md)
- [metrics.ts](file://packages/core/src/telemetry/metrics.ts)